import{r,j as e,t as c}from"./index-_T_dclBo.js";import{C as d,a as o,b as se,c as ae,e as te}from"./card-mM-adsMl.js";import{D as T,a as z,b as I,c as L,d as O}from"./dialog-R0K7NxxJ.js";import{I as u}from"./input-BvLdwGAG.js";import{L as p}from"./label-DvinGlq6.js";import{b as ie,B as m}from"./ownerService-CJxlrD2e.js";import{S as re}from"./switch-CDDxG62m.js";import{E as F,S as C}from"./EmptyState-CZE-0j11.js";import{u as ce,E as ne,a as le,P as de,C as oe}from"./useDebouncedValue-tealXdGx.js";import{u as me,a as xe}from"./useServices-6dh7S5Ff.js";import{P as he}from"./Dashboard-vSO5UD5A.js";import{C as ue}from"./circle-check-BWQBntIy.js";import{c as V}from"./createLucideIcon-vxqge8nX.js";import{S as ge}from"./search-1uIckXng.js";import{C as pe}from"./clock-Bb3qLlbr.js";import{T as je}from"./trash-2-DIkBWH60.js";import"./index-BHur5ELe.js";const ve=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],fe=V("circle-x",ve);const Ne=[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]],R=V("indian-rupee",Ne),U={name:"",category:"",price:0,duration:60,description:"",isActive:!0};function Fe({activeBranchId:x}){const[H,g]=r.useState(!1),[q,S]=r.useState(!1),[k,$]=r.useState(""),[G,v]=r.useState(1),[i,n]=r.useState(U),[t,f]=r.useState(null),A=ce(k),X=8;r.useEffect(()=>{v(1)},[A,x]);const{data:P,isLoading:J}=me({branchId:x,search:A,page:G,limit:X}),h=P?.items??[],l=P?.pagination,{create:D,update:M,updateStatus:N,remove:b}=xe(x),E=D.isPending||M.isPending||N.isPending||b.isPending,_=()=>{f(null),n(U),g(!0)},K=s=>{f(s),n({name:s.name,category:s.category||"",price:s.price||0,duration:s.duration||60,description:s.description||"",isActive:s.isActive!==!1}),g(!0)},Q=s=>{f(s),S(!0)},W=async()=>{if(!i.name){c.error("Name is required");return}try{t?(await M.mutateAsync({id:t._id,data:i}),c.success("Service updated")):(await D.mutateAsync({...i,branchId:x||void 0}),c.success("Service created")),g(!1)}catch(s){c.error(s?.message||"Unable to save service")}},Y=async s=>{try{await b.mutateAsync(s),c.success("Service deleted")}catch(a){c.error(a?.message||"Unable to delete service")}},Z=async(s,a)=>{try{await N.mutateAsync({id:s._id,isActive:a}),c.success(`Service ${a?"enabled":"disabled"}`)}catch(y){c.error(y?.message||"Unable to update status")}},j=r.useMemo(()=>{const s=l?.total??h.length,a=h.filter(w=>w.isActive!==!1).length,y=s-a,B=s>0?h.reduce((w,ee)=>w+(Number(ee.price)||0),0)/s:0;return{total:s,active:a,inactive:y,avgPrice:Math.round(B)}},[h,l?.total]);return x?e.jsxs("div",{className:"space-y-6",children:[e.jsx(ne,{title:"Services",description:"Manage the catalog visible to salon owners.",onCreate:_,createLabel:"Add Service",isCreateDisabled:!x}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(d,{className:"border-l-4 border-l-purple-500 hover:shadow-lg transition-shadow",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Total Services"}),e.jsx("div",{className:"text-2xl text-foreground mb-1",children:j.total})]}),e.jsx("div",{className:"shrink-0 w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx(he,{className:"w-5 h-5 text-purple-600"})})]})})}),e.jsx(d,{className:"border-l-4 border-l-green-500 hover:shadow-lg transition-shadow",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Active"}),e.jsx("div",{className:"text-2xl text-foreground mb-1",children:j.active})]}),e.jsx("div",{className:"shrink-0 w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(ue,{className:"w-5 h-5 text-green-600"})})]})})}),e.jsx(d,{className:"border-l-4 border-l-red-500 hover:shadow-lg transition-shadow",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Inactive"}),e.jsx("div",{className:"text-2xl text-foreground mb-1",children:j.inactive})]}),e.jsx("div",{className:"shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(fe,{className:"w-5 h-5 text-red-600"})})]})})}),e.jsx(d,{className:"border-l-4 border-l-amber-500 hover:shadow-lg transition-shadow",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Avg. Price"}),e.jsxs("div",{className:"text-2xl text-foreground mb-1",children:["₹",j.avgPrice]})]}),e.jsx("div",{className:"shrink-0 w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center",children:e.jsx(R,{className:"w-5 h-5 text-amber-600"})})]})})})]}),e.jsx(d,{className:"bg-card border-border",children:e.jsx(o,{className:"pt-6",children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(u,{placeholder:"Search services...",value:k,onChange:s=>$(s.target.value),className:"pl-10 bg-input-background border-border"})]})})})}),J?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:Array.from({length:6}).map((s,a)=>e.jsx(d,{children:e.jsxs(o,{className:"space-y-3 py-6",children:[e.jsx(C,{className:"h-6 w-32"}),e.jsx(C,{className:"h-4 w-48"}),e.jsx(C,{className:"h-4 w-20"})]})},a))}):h.length===0?e.jsx(F,{title:"No services yet",description:"Create services to help owners offer packages to clients.",actionLabel:"Add service",onAction:_}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:h.map(s=>e.jsxs(d,{children:[e.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0",children:[e.jsx(ae,{children:s.name}),e.jsx(ie,{variant:s.isActive?"default":"secondary",children:s.category||"General"})]}),e.jsxs(o,{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),s.price??0]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),s.duration??0," mins"]}),e.jsx("div",{children:s.description||"No description"})]}),e.jsxs(te,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{checked:s.isActive!==!1,onCheckedChange:a=>Z(s,a),disabled:N.isPending}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.isActive!==!1?"Active":"Disabled"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{size:"icon",variant:"ghost",onClick:()=>Q(s),children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(m,{size:"icon",variant:"ghost",onClick:()=>K(s),children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx(oe,{title:"Delete service",description:"This service will be hidden from scheduling.",onConfirm:()=>Y(s._id),trigger:e.jsx(m,{size:"icon",variant:"ghost",children:e.jsx(je,{className:"h-4 w-4"})}),disabled:b.isPending})]})]})]},s._id))}),l&&e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("div",{children:["Page ",l.page," of ",l.totalPages]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>v(s=>Math.max(s-1,1)),disabled:!l.hasPrev,children:"Previous"}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>v(s=>s+1),disabled:!l.hasNext,children:"Next"})]})]}),e.jsx(T,{open:H,onOpenChange:g,children:e.jsxs(z,{className:"max-w-lg",children:[e.jsxs(I,{children:[e.jsx(L,{children:t?"Edit Service":"Add Service"}),e.jsx(O,{className:"sr-only",children:t?"Update service details.":"Enter service details."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Name"}),e.jsx(u,{value:i.name,onChange:s=>n(a=>({...a,name:s.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Category"}),e.jsx(u,{value:i.category,onChange:s=>n(a=>({...a,category:s.target.value}))})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Price (₹)"}),e.jsx(u,{type:"number",value:i.price,onChange:s=>n(a=>({...a,price:Number(s.target.value)}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Duration (mins)"}),e.jsx(u,{type:"number",value:i.duration,onChange:s=>n(a=>({...a,duration:Number(s.target.value)}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Description"}),e.jsx(u,{value:i.description,onChange:s=>n(a=>({...a,description:s.target.value}))})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(m,{variant:"outline",onClick:()=>g(!1),disabled:E,children:"Cancel"}),e.jsx(m,{onClick:W,disabled:E,children:"Save"})]})]})}),e.jsx(T,{open:q,onOpenChange:S,children:e.jsxs(z,{children:[e.jsxs(I,{children:[e.jsx(L,{children:t?.name}),e.jsx(O,{className:"sr-only",children:"Review service details."})]}),e.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("div",{children:["Category: ",t?.category||"—"]}),e.jsxs("div",{children:["Price: ₹",t?.price??0]}),e.jsxs("div",{children:["Duration: ",t?.duration??0," mins"]}),e.jsxs("div",{children:["Description: ",t?.description||"—"]})]})]})})]}):e.jsx(F,{title:"Select a branch",description:"Choose a branch to manage services."})}export{Fe as default};
