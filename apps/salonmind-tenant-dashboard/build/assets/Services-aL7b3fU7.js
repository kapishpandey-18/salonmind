import{r,j as e,t as n}from"./index-DEsDXUSK.js";import{C as b,d as C,a as Y,b as Z,e as B}from"./card-CSfxeEk0.js";import{D as _,a as L,b as O,c as I}from"./dialog-DM_WnBAe.js";import{I as h}from"./input-fORRFi0u.js";import{L as p}from"./label-CZBKjXX6.js";import{c as ee,B as d}from"./SalonMindLogo-BdYlaItP.js";import{B as se}from"./ownerService-B2O02PeP.js";import{S as ae}from"./switch-CBTHbT7a.js";import{u as te,E as z,a as ie,S,b as re,P as ne,C as ce}from"./useDebouncedValue-zGanXLWo.js";import{u as de,a as le}from"./useServices-CMmBhyjA.js";import{C as oe}from"./clock-CLJWZEMI.js";import{T as me}from"./trash-2-B2_TkTN0.js";import"./index-prrkowPK.js";import"./Dashboard-Bh94dQr3.js";import"./search-BXv_aqr2.js";const xe=[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]],he=ee("indian-rupee",xe),F={name:"",category:"",price:0,duration:60,description:"",isActive:!0};function De({activeBranchId:l}){const[V,m]=r.useState(!1),[H,w]=r.useState(!1),[A,R]=r.useState(""),[U,u]=r.useState(1),[t,c]=r.useState(F),[i,g]=r.useState(null),k=te(A),q=8;r.useEffect(()=>{u(1)},[k,l]);const{data:P,isLoading:G}=de({branchId:l,search:k,page:U,limit:q}),o=P?.items??[],x=P?.pagination,{create:D,update:M,updateStatus:j,remove:v}=le(l),E=D.isPending||M.isPending||j.isPending||v.isPending,T=()=>{g(null),c(F),m(!0)},$=s=>{g(s),c({name:s.name,category:s.category||"",price:s.price||0,duration:s.duration||60,description:s.description||"",isActive:s.isActive!==!1}),m(!0)},J=s=>{g(s),w(!0)},K=async()=>{if(!t.name){n.error("Name is required");return}try{i?(await M.mutateAsync({id:i._id,data:t}),n.success("Service updated")):(await D.mutateAsync({...t,branchId:l||void 0}),n.success("Service created")),m(!1)}catch(s){n.error(s?.message||"Unable to save service")}},Q=async s=>{try{await v.mutateAsync(s),n.success("Service deleted")}catch(a){n.error(a?.message||"Unable to delete service")}},W=async(s,a)=>{try{await j.mutateAsync({id:s._id,isActive:a}),n.success(`Service ${a?"enabled":"disabled"}`)}catch(y){n.error(y?.message||"Unable to update status")}},f=r.useMemo(()=>{const s=o.length,a=o.filter(N=>N.isActive!==!1).length,y=s>0?o.reduce((N,X)=>N+(Number(X.price)||0),0)/s:0;return{total:s,active:a,avgPrice:Math.round(y)}},[o]);return l?e.jsxs("div",{className:"space-y-6",children:[e.jsx(ie,{title:"Services",description:"Manage the catalog visible to salon owners.",searchValue:A,onSearchChange:R,onCreate:T,createLabel:"Add Service",isCreateDisabled:!l}),e.jsx(b,{children:e.jsxs(C,{className:"grid gap-4 py-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Services"}),e.jsx("p",{className:"text-2xl font-semibold",children:f.total})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active"}),e.jsx("p",{className:"text-2xl font-semibold",children:f.active})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg. Price"}),e.jsxs("p",{className:"text-2xl font-semibold",children:["₹",f.avgPrice]})]})]})}),G?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:Array.from({length:6}).map((s,a)=>e.jsx(b,{children:e.jsxs(C,{className:"space-y-3 py-6",children:[e.jsx(S,{className:"h-6 w-32"}),e.jsx(S,{className:"h-4 w-48"}),e.jsx(S,{className:"h-4 w-20"})]})},a))}):o.length===0?e.jsx(z,{title:"No services yet",description:"Create services to help owners offer packages to clients.",actionLabel:"Add service",onAction:T}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:o.map(s=>e.jsxs(b,{children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between space-y-0",children:[e.jsx(Z,{children:s.name}),e.jsx(se,{variant:s.isActive?"default":"secondary",children:s.category||"General"})]}),e.jsxs(C,{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),s.price??0]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),s.duration??0," mins"]}),e.jsx("div",{children:s.description||"No description"})]}),e.jsxs(B,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{checked:s.isActive!==!1,onCheckedChange:a=>W(s,a),disabled:j.isPending}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.isActive!==!1?"Active":"Disabled"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{size:"icon",variant:"ghost",onClick:()=>J(s),children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx(d,{size:"icon",variant:"ghost",onClick:()=>$(s),children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsx(ce,{title:"Delete service",description:"This service will be hidden from scheduling.",onConfirm:()=>Q(s._id),trigger:e.jsx(d,{size:"icon",variant:"ghost",children:e.jsx(me,{className:"h-4 w-4"})}),disabled:v.isPending})]})]})]},s._id))}),x&&e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("div",{children:["Page ",x.page," of ",x.totalPages]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:()=>u(s=>Math.max(s-1,1)),disabled:!x.hasPrev,children:"Previous"}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>u(s=>s+1),disabled:!x.hasNext,children:"Next"})]})]}),e.jsx(_,{open:V,onOpenChange:m,children:e.jsxs(L,{className:"max-w-lg",children:[e.jsx(O,{children:e.jsx(I,{children:i?"Edit Service":"Add Service"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Name"}),e.jsx(h,{value:t.name,onChange:s=>c(a=>({...a,name:s.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Category"}),e.jsx(h,{value:t.category,onChange:s=>c(a=>({...a,category:s.target.value}))})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Price (₹)"}),e.jsx(h,{type:"number",value:t.price,onChange:s=>c(a=>({...a,price:Number(s.target.value)}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Duration (mins)"}),e.jsx(h,{type:"number",value:t.duration,onChange:s=>c(a=>({...a,duration:Number(s.target.value)}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Description"}),e.jsx(h,{value:t.description,onChange:s=>c(a=>({...a,description:s.target.value}))})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(d,{variant:"outline",onClick:()=>m(!1),disabled:E,children:"Cancel"}),e.jsx(d,{onClick:K,disabled:E,children:"Save"})]})]})}),e.jsx(_,{open:H,onOpenChange:w,children:e.jsxs(L,{children:[e.jsx(O,{children:e.jsx(I,{children:i?.name})}),e.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("div",{children:["Category: ",i?.category||"—"]}),e.jsxs("div",{children:["Price: ₹",i?.price??0]}),e.jsxs("div",{children:["Duration: ",i?.duration??0," mins"]}),e.jsxs("div",{children:["Description: ",i?.description||"—"]})]})]})})]}):e.jsx(z,{title:"Select a branch",description:"Choose a branch to manage services."})}export{De as default};
